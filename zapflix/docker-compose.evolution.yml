version: '3.8'

services:
  evolution-api:
    image: atendai/evolution-api:latest
    container_name: zapflix-evolution
    restart: unless-stopped
    ports:
      - "8081:8080"
    environment:
      # Autenticação
      - AUTHENTICATION_API_KEY=${EVOLUTION_API_KEY}
      
      # Banco de Dados (MongoDB)
      - DATABASE_ENABLED=true
      - DATABASE_CONNECTION_URI=${MONGODB_URI}
      - DATABASE_CONNECTION_DB_PREFIX_NAME=zapflix
      
      # Webhook Global
      - WEBHOOK_GLOBAL_URL=${BACKEND_URL}/api/webhooks/evolution
      - WEBHOOK_GLOBAL_ENABLED=true
      - WEBHOOK_GLOBAL_WEBHOOK_BY_EVENTS=true
      
      # Configurações de Instância
      - CONFIG_SESSION_PHONE_CLIENT=ZapFlix
      - CONFIG_SESSION_PHONE_NAME=chrome
      
      # Logs
      - LOG_LEVEL=INFO
      - LOG_COLOR=true
      
      # QR Code
      - QRCODE_LIMIT=30
      - QRCODE_COLOR=#198754
      
    volumes:
      - evolution_instances:/evolution/instances
    networks:
      - zapflix-network

volumes:
  evolution_instances:
    driver: local

networks:
  zapflix-network:
    driver: bridge
